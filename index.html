<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Today's Agenda</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #121212;
            color: #ffffff;
            font-family: Arial, sans-serif;
        }

        #agenda-card {
            background: #1e1e1e;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            max-width: 80%;
            text-align: center;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
        }

        #agenda-card.show {
            opacity: 1;
            transform: translateY(0);
        }

        #agenda-card:hover {
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.5);
        }

        #agenda-card h1 {
            margin: 0;
            font-size: 2em;
            color: #64ffda;
        }

        #agenda-card p {
            font-size: 1.2em;
            color: #cccccc;
        }

        #loading {
            color: #888888;
            font-size: 1.5em;
        }
    </style>
</head>
<body>
    <div id="loading">Loading today's agenda...</div>

    <div id="agenda-card">
        <h1>Today's Agenda</h1>
        <p id="agenda-text">No agenda for today.</p>
    </div>

    <script>
        const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSHeWrdfZFC9n1kUQ7-QfatBeyuNsCQFqmGvk8m9a4Bt3rzuoqHNyoIoiWLcCX3capHb3Bza3ezQzQy/pub?output=csv";

        // Format date as "M/D/YYYY"
        function formatDateToString(date) {
            return `${date.getMonth() + 1}/${date.getDate()}/${date.getFullYear()}`;
        }

        // Fetch and parse CSV data
        async function fetchCSVData() {
            try {
                const response = await fetch(`${csvUrl}&nocache=${Math.random()}`);
                const csvText = await response.text();
                return parseCSV(csvText);
            } catch (error) {
                console.error("Error fetching CSV data:", error);
                return [];
            }
        }

        // Parse CSV text into an array of objects
        function parseCSV(csvText) {
            const lines = csvText.split("\n");
            const headers = lines[0].split(",").map(header => header.trim().toLowerCase());
            return lines.slice(1).map(line => {
                const cols = line.split(",");
                return {
                    date: cols[0].trim(),
                    agenda: cols[1] ? cols[1].trim() : ""
                };
            });
        }

        // Display agenda for today
        async function displayAgendaForToday() {
            const today = new Date();
            const formattedDate = formatDateToString(today);
            const data = await fetchCSVData();
            console.log("Formatted Date:", formattedDate);
            console.log("Agenda Data:", data);

            const todayAgenda = data.find(item => item.date === formattedDate);

            document.getElementById("loading").style.display = "none";
            const agendaCard = document.getElementById("agenda-card");
            const agendaText = document.getElementById("agenda-text");

            if (todayAgenda) {
                agendaText.textContent = todayAgenda.agenda;
            } else {
                agendaText.textContent = "No agenda for today.";
            }

            // Show the agenda card with animation
            agendaCard.classList.add("show");
        }

        // Initial load
        window.onload = () => {
            displayAgendaForToday();
        };
    </script>
</body>
</html>
